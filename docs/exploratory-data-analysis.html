<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Study notes</title>
  <meta name="description" content="Study notes taken from courses and self learning.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Study notes" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://github.com/James-SR/study-notes-master" />
  
  <meta property="og:description" content="Study notes taken from courses and self learning." />
  <meta name="github-repo" content="James-SR/study-notes-master" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Study notes" />
  
  <meta name="twitter:description" content="Study notes taken from courses and self learning." />
  

<meta name="author" content="James Solomon-Rounce">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="references-2.html">
<link rel="next" href="correlation-and-regression.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Study Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="importing-data-part-1.html"><a href="importing-data-part-1.html"><i class="fa fa-check"></i><b>1</b> Importing data - Part 1</a><ul>
<li class="chapter" data-level="1.1" data-path="importing-data-part-1.html"><a href="importing-data-part-1.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="importing-data-part-1.html"><a href="importing-data-part-1.html#reading-csv-files"><i class="fa fa-check"></i><b>1.2</b> Reading CSV files</a></li>
<li class="chapter" data-level="1.3" data-path="importing-data-part-1.html"><a href="importing-data-part-1.html#reading-tab-deliminated-files-or-other-table-formats"><i class="fa fa-check"></i><b>1.3</b> Reading tab deliminated files or other table formats</a></li>
<li class="chapter" data-level="1.4" data-path="importing-data-part-1.html"><a href="importing-data-part-1.html#readr-and-data.table"><i class="fa fa-check"></i><b>1.4</b> Readr and data.table</a><ul>
<li class="chapter" data-level="1.4.1" data-path="importing-data-part-1.html"><a href="importing-data-part-1.html#data.table-fread"><i class="fa fa-check"></i><b>1.4.1</b> data.table fread</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="importing-data-part-1.html"><a href="importing-data-part-1.html#reading-excel-files"><i class="fa fa-check"></i><b>1.5</b> Reading Excel files</a><ul>
<li class="chapter" data-level="1.5.1" data-path="importing-data-part-1.html"><a href="importing-data-part-1.html#alternatives-for-importing-excel-files"><i class="fa fa-check"></i><b>1.5.1</b> Alternatives for importing Excel files</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="importing-data-part-1.html"><a href="importing-data-part-1.html#xlconnect---read-and-write-to-excel"><i class="fa fa-check"></i><b>1.6</b> XLConnect - read and write to excel</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importing-data-part-2.html"><a href="importing-data-part-2.html"><i class="fa fa-check"></i><b>2</b> Importing data - Part 2</a><ul>
<li class="chapter" data-level="2.1" data-path="importing-data-part-2.html"><a href="importing-data-part-2.html#importing-from-databases---1"><i class="fa fa-check"></i><b>2.1</b> Importing from Databases - 1</a></li>
<li class="chapter" data-level="2.2" data-path="importing-data-part-2.html"><a href="importing-data-part-2.html#sql-queries-inside-r"><i class="fa fa-check"></i><b>2.2</b> SQL Queries Inside R</a></li>
<li class="chapter" data-level="2.3" data-path="importing-data-part-2.html"><a href="importing-data-part-2.html#web-data"><i class="fa fa-check"></i><b>2.3</b> Web Data</a></li>
<li class="chapter" data-level="2.4" data-path="importing-data-part-2.html"><a href="importing-data-part-2.html#json-and-apis"><i class="fa fa-check"></i><b>2.4</b> JSON and APIs</a></li>
<li class="chapter" data-level="2.5" data-path="importing-data-part-2.html"><a href="importing-data-part-2.html#importing-from-other-statistical-software"><i class="fa fa-check"></i><b>2.5</b> Importing from other statistical software</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="3" data-path="cleaning-data.html"><a href="cleaning-data.html"><i class="fa fa-check"></i><b>3</b> Cleaning Data</a><ul>
<li class="chapter" data-level="3.1" data-path="cleaning-data.html"><a href="cleaning-data.html#tidying-data"><i class="fa fa-check"></i><b>3.1</b> Tidying data</a></li>
<li class="chapter" data-level="3.2" data-path="cleaning-data.html"><a href="cleaning-data.html#preparing-data-for-analysis"><i class="fa fa-check"></i><b>3.2</b> Preparing data for analysis</a></li>
<li class="chapter" data-level="3.3" data-path="cleaning-data.html"><a href="cleaning-data.html#string-manipulation"><i class="fa fa-check"></i><b>3.3</b> String manipulation</a></li>
<li class="chapter" data-level="3.4" data-path="cleaning-data.html"><a href="cleaning-data.html#missing-specials-and-outliers"><i class="fa fa-check"></i><b>3.4</b> Missing, Specials and Outliers</a></li>
<li class="chapter" data-level="3.5" data-path="cleaning-data.html"><a href="cleaning-data.html#examples"><i class="fa fa-check"></i><b>3.5</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="importing-cleaning-data-in-r-case-studies.html"><a href="importing-cleaning-data-in-r-case-studies.html"><i class="fa fa-check"></i><b>4</b> Importing &amp; Cleaning Data in R: Case Studies</a><ul>
<li class="chapter" data-level="4.1" data-path="importing-cleaning-data-in-r-case-studies.html"><a href="importing-cleaning-data-in-r-case-studies.html#ticket-sales-data"><i class="fa fa-check"></i><b>4.1</b> Ticket Sales Data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="importing-cleaning-data-in-r-case-studies.html"><a href="importing-cleaning-data-in-r-case-studies.html#removing-redundant-info"><i class="fa fa-check"></i><b>4.1.1</b> Removing redundant info</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="importing-cleaning-data-in-r-case-studies.html"><a href="importing-cleaning-data-in-r-case-studies.html#working-with-dates"><i class="fa fa-check"></i><b>4.2</b> Working with dates</a></li>
<li class="chapter" data-level="4.3" data-path="importing-cleaning-data-in-r-case-studies.html"><a href="importing-cleaning-data-in-r-case-studies.html#mbta-ridership-data"><i class="fa fa-check"></i><b>4.3</b> MBTA Ridership Data</a></li>
<li class="chapter" data-level="4.4" data-path="importing-cleaning-data-in-r-case-studies.html"><a href="importing-cleaning-data-in-r-case-studies.html#world-food-facts"><i class="fa fa-check"></i><b>4.4</b> World Food Facts</a></li>
<li class="chapter" data-level="4.5" data-path="importing-cleaning-data-in-r-case-studies.html"><a href="importing-cleaning-data-in-r-case-studies.html#school-attendance-data"><i class="fa fa-check"></i><b>4.5</b> School Attendance Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-data.html"><a href="introduction-to-data.html"><i class="fa fa-check"></i><b>5</b> Introduction to Data</a><ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-data.html"><a href="introduction-to-data.html#language-of-data"><i class="fa fa-check"></i><b>5.1</b> Language of Data</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-data.html"><a href="introduction-to-data.html#observational-studies-and-experiments"><i class="fa fa-check"></i><b>5.2</b> Observational Studies and Experiments</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-data.html"><a href="introduction-to-data.html#sampling-strategies-and-experimental-design"><i class="fa fa-check"></i><b>5.3</b> Sampling strategies and experimental design</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="6" data-path="foundations-of-inference.html"><a href="foundations-of-inference.html"><i class="fa fa-check"></i><b>6</b> Foundations of Inference</a><ul>
<li class="chapter" data-level="6.1" data-path="foundations-of-inference.html"><a href="foundations-of-inference.html#introduction-to-inference"><i class="fa fa-check"></i><b>6.1</b> Introduction to Inference</a></li>
<li class="chapter" data-level="6.2" data-path="foundations-of-inference.html"><a href="foundations-of-inference.html#home-ownership-by-gender"><i class="fa fa-check"></i><b>6.2</b> Home Ownership by Gender</a></li>
<li class="chapter" data-level="6.3" data-path="foundations-of-inference.html"><a href="foundations-of-inference.html#density-plots"><i class="fa fa-check"></i><b>6.3</b> Density Plots</a></li>
<li class="chapter" data-level="6.4" data-path="foundations-of-inference.html"><a href="foundations-of-inference.html#gender-discrimination-p-values"><i class="fa fa-check"></i><b>6.4</b> Gender Discrimination (p-values)</a></li>
<li class="chapter" data-level="6.5" data-path="foundations-of-inference.html"><a href="foundations-of-inference.html#opportunity-cost"><i class="fa fa-check"></i><b>6.5</b> Opportunity Cost</a></li>
<li class="chapter" data-level="6.6" data-path="foundations-of-inference.html"><a href="foundations-of-inference.html#type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>6.6</b> Type I and Type II errors</a></li>
<li class="chapter" data-level="6.7" data-path="foundations-of-inference.html"><a href="foundations-of-inference.html#bootstrapping"><i class="fa fa-check"></i><b>6.7</b> Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-2.html"><a href="references-2.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>7</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#categorical-data"><i class="fa fa-check"></i><b>7.1</b> Categorical Data</a></li>
<li class="chapter" data-level="7.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#numerical-data"><i class="fa fa-check"></i><b>7.2</b> Numerical Data</a></li>
<li class="chapter" data-level="7.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#numerical-summaries"><i class="fa fa-check"></i><b>7.3</b> Numerical Summaries</a><ul>
<li class="chapter" data-level="7.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#transformations"><i class="fa fa-check"></i><b>7.3.1</b> Transformations</a></li>
<li class="chapter" data-level="7.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#outliers"><i class="fa fa-check"></i><b>7.3.2</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#email-case-study"><i class="fa fa-check"></i><b>7.4</b> Email Case Study</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html"><i class="fa fa-check"></i><b>8</b> Correlation and Regression</a><ul>
<li class="chapter" data-level="8.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#visualizing-two-variables"><i class="fa fa-check"></i><b>8.1</b> Visualizing two variables</a><ul>
<li class="chapter" data-level="8.1.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#transformations-1"><i class="fa fa-check"></i><b>8.1.1</b> Transformations</a></li>
<li class="chapter" data-level="8.1.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#identifying-outliers"><i class="fa fa-check"></i><b>8.1.2</b> Identifying Outliers</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#correlation"><i class="fa fa-check"></i><b>8.2</b> Correlation</a><ul>
<li class="chapter" data-level="8.2.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#anscombe-dataset"><i class="fa fa-check"></i><b>8.2.1</b> Anscombe Dataset</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#linear-regression"><i class="fa fa-check"></i><b>8.3</b> Linear Regression</a><ul>
<li class="chapter" data-level="8.3.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#regression-to-the-mean"><i class="fa fa-check"></i><b>8.3.1</b> Regression to the Mean</a></li>
<li class="chapter" data-level="8.3.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#fitting-linear-models"><i class="fa fa-check"></i><b>8.3.2</b> Fitting linear models</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#model-fit"><i class="fa fa-check"></i><b>8.4</b> Model fit</a><ul>
<li class="chapter" data-level="8.4.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#unusual-points"><i class="fa fa-check"></i><b>8.4.1</b> Unusual points</a></li>
<li class="chapter" data-level="8.4.2" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#high-leverage-points"><i class="fa fa-check"></i><b>8.4.2</b> High leverage Points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>9</b> Supervised Learning</a><ul>
<li class="chapter" data-level="9.1" data-path="supervised-learning.html"><a href="supervised-learning.html#tree-based-models"><i class="fa fa-check"></i><b>9.1</b> Tree Based Models</a><ul>
<li class="chapter" data-level="9.1.1" data-path="supervised-learning.html"><a href="supervised-learning.html#random-forests"><i class="fa fa-check"></i><b>9.1.1</b> Random Forests</a></li>
<li class="chapter" data-level="9.1.2" data-path="supervised-learning.html"><a href="supervised-learning.html#one-hot-encoding-categorical-variables"><i class="fa fa-check"></i><b>9.1.2</b> One-Hot-Encoding Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="supervised-learning.html"><a href="supervised-learning.html#gradient-boosting-machines"><i class="fa fa-check"></i><b>9.2</b> Gradient Boosting Machines</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dimensional-modelling.html"><a href="dimensional-modelling.html"><i class="fa fa-check"></i><b>10</b> Dimensional Modelling</a><ul>
<li class="chapter" data-level="10.1" data-path="dimensional-modelling.html"><a href="dimensional-modelling.html#introduction-to-dimensional-data"><i class="fa fa-check"></i><b>10.1</b> Introduction to Dimensional Data</a><ul>
<li class="chapter" data-level="10.1.1" data-path="dimensional-modelling.html"><a href="dimensional-modelling.html#data-modelling-levels"><i class="fa fa-check"></i><b>10.1.1</b> Data Modelling levels</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="dimensional-modelling.html"><a href="dimensional-modelling.html#architecture-considerations"><i class="fa fa-check"></i><b>10.2</b> Architecture considerations</a></li>
<li class="chapter" data-level="10.3" data-path="dimensional-modelling.html"><a href="dimensional-modelling.html#graphical-representations"><i class="fa fa-check"></i><b>10.3</b> Graphical Representations</a></li>
<li class="chapter" data-level="10.4" data-path="dimensional-modelling.html"><a href="dimensional-modelling.html#kimball-approach"><i class="fa fa-check"></i><b>10.4</b> Kimball Approach</a></li>
<li class="chapter" data-level="10.5" data-path="dimensional-modelling.html"><a href="dimensional-modelling.html#four-step-dimensional-design-process"><i class="fa fa-check"></i><b>10.5</b> Four-Step Dimensional Design Process</a></li>
<li class="chapter" data-level="10.6" data-path="dimensional-modelling.html"><a href="dimensional-modelling.html#tips"><i class="fa fa-check"></i><b>10.6</b> Tips</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-3.html"><a href="references-3.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Study notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exploratory-data-analysis" class="section level1">
<h1><span class="header-section-number">7</span> Exploratory Data Analysis</h1>
<hr />
<p>Notes taken during/inspired by the Datacamp course “Exploratory Data Analysis” by Andrew Bray.</p>
<div id="categorical-data" class="section level2">
<h2><span class="header-section-number">7.1</span> Categorical Data</h2>
<p>Common functions when looking at categorical, aka factors variables, are levels(df<span class="math inline">\(var) and to get a contigency or xtab table the table(df\)</span>var1, df$var2). We can also create bar charts to visually represent the data using ggplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read in our dataset thanks to fivethirtyeight https://github.com/fivethirtyeight/data/tree/master/comic-characters</span>

comics &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/fivethirtyeight/data/master/comic-characters/dc-wikia-data.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)
comics$name &lt;-<span class="st"> </span><span class="kw">as.character</span>(comics$name)

<span class="co"># Check levels of align</span>
<span class="kw">levels</span>(comics$ALIGN)</code></pre></div>
<pre><code>## [1] &quot;&quot;                   &quot;Bad Characters&quot;     &quot;Good Characters&quot;   
## [4] &quot;Neutral Characters&quot; &quot;Reformed Criminals&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check the levels of gender</span>
<span class="kw">levels</span>(comics$SEX)</code></pre></div>
<pre><code>## [1] &quot;&quot;                       &quot;Female Characters&quot;     
## [3] &quot;Genderless Characters&quot;  &quot;Male Characters&quot;       
## [5] &quot;Transgender Characters&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a 2-way contingency table</span>
<span class="kw">table</span>(comics$ALIGN, comics$SEX)</code></pre></div>
<pre><code>##                     
##                           Female Characters Genderless Characters
##                        25               220                     0
##   Bad Characters       63               597                    11
##   Good Characters      30               953                     6
##   Neutral Characters    7               196                     3
##   Reformed Criminals    0                 1                     0
##                     
##                      Male Characters Transgender Characters
##                                  356                      0
##   Bad Characters                2223                      1
##   Good Characters               1843                      0
##   Neutral Characters             359                      0
##   Reformed Criminals               2                      0</code></pre>
<p>To simplify an analysis, it often helps to drop levels with small amounts of data. In R, this requires two steps: first filtering out any rows with the levels that have very low counts, then removing these levels from the factor variable with droplevels(). This is because the droplevels() function would keep levels that have just 1 or 2 counts; it only drops levels that don“t exist in a dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load dplyr</span>
<span class="kw">library</span>(dplyr)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Remove align level</span>
comics &lt;-<span class="st"> </span>comics %&gt;%
<span class="st">  </span><span class="kw">filter</span>(ALIGN !=<span class="st"> &quot;Reformed Criminals&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">droplevels</span>()</code></pre></div>
<p>While a contingency table represents the counts numerically, it“s often more useful to represent them graphically.</p>
<p>Here you“ll construct two side-by-side barcharts of the comics data. This shows that there can often be two or more options for presenting the same data. Passing the argument position =”dodge&quot; to geom_bar() says that you want a side-by-side (i.e. not stacked) barchart.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load ggplot2</span>
<span class="kw">library</span>(ggplot2)

<span class="co"># Create side-by-side barchart of gender by alignment</span>
<span class="kw">ggplot</span>(comics, <span class="kw">aes</span>(<span class="dt">x =</span> ALIGN, <span class="dt">fill =</span> SEX)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create side-by-side barchart of alignment by gender</span>
<span class="kw">ggplot</span>(comics, <span class="kw">aes</span>(<span class="dt">x =</span> SEX, <span class="dt">fill =</span> ALIGN)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>))</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<p>When creatign tables, it is often easier to look at proportions for patterns rather than counts. We can do this using conditional proportions, by using the prop.table(df_counts, n) where n is the number we want to condition our frequency/count table by, 1 = rows and 2 = columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tab &lt;-<span class="st"> </span><span class="kw">table</span>(comics$ALIGN, comics$SEX)
<span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">999</span>, <span class="dt">digits =</span> <span class="dv">2</span>) <span class="co"># Print fewer digits</span>
<span class="kw">prop.table</span>(tab)     <span class="co"># Joint proportions (totals in the entire table)</span></code></pre></div>
<pre><code>##                     
##                              Female Characters Genderless Characters
##                      0.00363           0.03192               0.00000
##   Bad Characters     0.00914           0.08661               0.00160
##   Good Characters    0.00435           0.13826               0.00087
##   Neutral Characters 0.00102           0.02843               0.00044
##                     
##                      Male Characters Transgender Characters
##                              0.05165                0.00000
##   Bad Characters             0.32250                0.00015
##   Good Characters            0.26737                0.00000
##   Neutral Characters         0.05208                0.00000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(tab, <span class="dv">2</span>)  <span class="co"># Conditional on columns (column totals)</span></code></pre></div>
<pre><code>##                     
##                            Female Characters Genderless Characters
##                      0.200             0.112                 0.000
##   Bad Characters     0.504             0.304                 0.550
##   Good Characters    0.240             0.485                 0.300
##   Neutral Characters 0.056             0.100                 0.150
##                     
##                      Male Characters Transgender Characters
##                                0.074                  0.000
##   Bad Characters               0.465                  1.000
##   Good Characters              0.385                  0.000
##   Neutral Characters           0.075                  0.000</code></pre>
<p>Here we see that approx. 49% of female characters are good, compared to 39% for males.</p>
<p>Bar charts can tell dramatically different stories depending on whether they represent counts or proportions and, if proportions, what the proportions are conditioned on. To demonstrate this difference, you“ll construct two barcharts in this exercise: one of counts and one of proportions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot of gender by align</span>
<span class="kw">ggplot</span>(comics, <span class="kw">aes</span>(<span class="dt">x =</span> ALIGN, <span class="dt">fill =</span> SEX)) +
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot proportion of gender, conditional on align</span>
<span class="kw">ggplot</span>(comics, <span class="kw">aes</span>(<span class="dt">x =</span> ALIGN, <span class="dt">fill =</span> SEX)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>)</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<p><strong>Conditional barchart</strong></p>
<p>Now, if you want to break down the distribution of alignment based on gender, you“re looking for conditional distributions.</p>
<p>You could make these by creating multiple filtered datasets (one for each gender) or by faceting the plot of alignment based on gender. As a point of comparison, we“ve provided your plot of the marginal distribution of alignment from the last exercise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot of alignment broken down by gender</span>
<span class="kw">ggplot</span>(comics, <span class="kw">aes</span>(<span class="dt">x =</span> ALIGN)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>() +
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>SEX)</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="numerical-data" class="section level2">
<h2><span class="header-section-number">7.2</span> Numerical Data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data courtesy of http://www.idvbook.com/teaching-aid/data-sets/ with some variable name modifictions to match those in the exercise</span>
<span class="kw">library</span>(readxl)
cars &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;04cars data.xls&quot;</span>, <span class="dt">sheet =</span> <span class="dv">1</span>)
cars &lt;-<span class="st"> </span>cars[-<span class="dv">2</span>] <span class="co"># remove variable 2</span>

<span class="co"># Rename vars</span>
<span class="kw">names</span>(cars) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;sports_car&quot;</span>, <span class="st">&quot;suv&quot;</span>, <span class="st">&quot;wagon&quot;</span>, <span class="st">&quot;minivan&quot;</span>, <span class="st">&quot;pickup&quot;</span>, <span class="st">&quot;all_wheel&quot;</span>, 
                <span class="st">&quot;rear_wheel&quot;</span>, <span class="st">&quot;msrp&quot;</span>, <span class="st">&quot;dealer_cost&quot;</span>, <span class="st">&quot;eng_size&quot;</span>, <span class="st">&quot;ncyl&quot;</span>, <span class="st">&quot;horsepwr&quot;</span>,
                <span class="st">&quot;city_mpg&quot;</span>,<span class="st">&quot;hwy_mpg&quot;</span>,  <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;wheel_base&quot;</span>, <span class="st">&quot;length&quot;</span>, <span class="st">&quot;width&quot;</span>)
<span class="co"># Change data tpyes as needed</span>
cars[<span class="dv">2</span>:<span class="dv">7</span>] &lt;-<span class="st"> </span><span class="kw">sapply</span>(cars[<span class="dv">2</span>:<span class="dv">7</span>],as.logical)
cars[<span class="kw">c</span>(<span class="dv">8</span>:<span class="dv">10</span>,<span class="dv">12</span>:<span class="dv">19</span>)] &lt;-<span class="st"> </span><span class="kw">sapply</span>(cars[<span class="kw">c</span>(<span class="dv">8</span>:<span class="dv">10</span>,<span class="dv">12</span>:<span class="dv">19</span>)],as.integer)</code></pre></div>
<pre><code>## Warning in lapply(X = X, FUN = FUN, ...): NAs introduced by coercion

## Warning in lapply(X = X, FUN = FUN, ...): NAs introduced by coercion

## Warning in lapply(X = X, FUN = FUN, ...): NAs introduced by coercion

## Warning in lapply(X = X, FUN = FUN, ...): NAs introduced by coercion

## Warning in lapply(X = X, FUN = FUN, ...): NAs introduced by coercion

## Warning in lapply(X = X, FUN = FUN, ...): NAs introduced by coercion</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Learn data structure</span>
<span class="kw">str</span>(cars)</code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    428 obs. of  19 variables:
##  $ name       : chr  &quot;Acura 3.5 RL 4dr&quot; &quot;Acura 3.5 RL w/Navigation 4dr&quot; &quot;Acura MDX&quot; &quot;Acura NSX coupe 2dr manual S&quot; ...
##  $ sports_car : logi  FALSE FALSE FALSE TRUE FALSE FALSE ...
##  $ suv        : logi  FALSE FALSE TRUE FALSE FALSE FALSE ...
##  $ wagon      : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ minivan    : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ pickup     : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ all_wheel  : logi  FALSE FALSE TRUE FALSE FALSE FALSE ...
##  $ rear_wheel : int  0 0 0 1 0 0 0 0 0 0 ...
##  $ msrp       : int  43755 46100 36945 89765 23820 33195 26990 25940 31840 42490 ...
##  $ dealer_cost: int  39014 41100 33337 79978 21761 30299 24647 23508 28846 38325 ...
##  $ eng_size   : num  3.5 3.5 3.5 3.2 2 3.2 2.4 1.8 3 3 ...
##  $ ncyl       : int  6 6 6 6 4 6 4 4 6 6 ...
##  $ horsepwr   : int  225 225 265 290 200 270 200 170 220 220 ...
##  $ city_mpg   : int  18 18 17 17 24 20 22 22 20 20 ...
##  $ hwy_mpg    : int  24 24 23 24 31 28 29 31 28 27 ...
##  $ weight     : int  3880 3893 4451 3153 2778 3575 3230 3252 3462 3814 ...
##  $ wheel_base : int  115 115 106 100 101 108 105 104 104 105 ...
##  $ length     : int  197 197 189 174 172 186 183 179 179 180 ...
##  $ width      : int  72 72 77 71 68 72 69 70 70 70 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create faceted histogram</span>
<span class="kw">ggplot</span>(cars, <span class="kw">aes</span>(<span class="dt">x =</span> city_mpg)) +
<span class="st">  </span><span class="kw">geom_histogram</span>() +
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>suv)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 14 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>The mileage of a car tends to be associated with the size of its engine (as measured by the number of cylinders). To explore the relationship between these two variables, you could stick to using histograms, but in this exercise you“ll try your hand at two alternatives: the box plot and the density plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Filter cars with 4, 6, 8 cylinders</span>
common_cyl &lt;-<span class="st"> </span><span class="kw">filter</span>(cars, ncyl %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>))

<span class="co"># Create box plots of city mpg by ncyl</span>
<span class="kw">ggplot</span>(common_cyl, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.factor</span>(ncyl), <span class="dt">y =</span> city_mpg)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<pre><code>## Warning: Removed 11 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create overlaid density plots for same data</span>
<span class="kw">ggplot</span>(common_cyl, <span class="kw">aes</span>(<span class="dt">x =</span> city_mpg, <span class="dt">fill =</span> <span class="kw">as.factor</span>(ncyl))) +
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> .<span class="dv">3</span>)</code></pre></div>
<pre><code>## Warning: Removed 11 rows containing non-finite values (stat_density).</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<p>Now, turn your attention to a new variable: horsepwr. The goal is to get a sense of the marginal distribution of this variable and then compare it to the distribution of horsepower conditional on the price of the car being less than $25,000.</p>
<p>You“ll be making two plots using the”data pipeline&quot; paradigm, where you start with the raw data and end with the plot.</p>
<p>In addition to indicating the center and spread of a distribution, a box plot provides a graphical means to detect outliers. You can apply this method to the msrp column (manufacturer“s suggested retail price) to detect if there are unusually expensive or cheap cars.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create hist</span>
cars %&gt;%<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(horsepwr)) +
<span class="st">  </span><span class="kw">geom_histogram</span>() +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;ALL Cars&quot;</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create hist of horsepwr for affordable cars</span>
cars %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(msrp &lt;<span class="st"> </span><span class="dv">25000</span>) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(horsepwr)) +
<span class="st">  </span><span class="kw">geom_histogram</span>() +
<span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">550</span>)) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Affordable Cars&quot;</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_bar).</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Construct box plot of msrp</span>
cars %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> msrp)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Exclude outliers from data</span>
cars_no_out &lt;-<span class="st"> </span>cars %&gt;%
<span class="st">  </span><span class="kw">filter</span>(msrp &lt;<span class="st"> </span><span class="dv">100000</span>) 

<span class="co"># Construct box plot of msrp using the reduced dataset</span>
cars_no_out %&gt;%
<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> msrp)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<p>Consider two other columns in the cars dataset: city_mpg and width. Which is the most appropriate plot for displaying the important features of their distributions? Remember, both density plots and box plots display the central tendency and spread of the data, but the box plot is more robust to outliers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create plot of city_mpg</span>
cars %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> width)) +
<span class="st">  </span><span class="kw">geom_density</span>()</code></pre></div>
<pre><code>## Warning: Removed 28 rows containing non-finite values (stat_density).</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create plot of width</span>
cars %&gt;%
<span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> city_mpg)) +
<span class="st">   </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<pre><code>## Warning: Removed 14 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<p>Faceting is a valuable technique for looking at several conditional distributions at the same time. If the faceted distributions are laid out in a grid, you can consider the association between a variable and two others, one on the rows of the grid and the other on the columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Facet hists using hwy mileage and ncyl</span>
common_cyl %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hwy_mpg)) +
<span class="st">  </span><span class="kw">geom_histogram</span>() +
<span class="st">  </span><span class="kw">facet_grid</span>(ncyl ~<span class="st"> </span>suv) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Faceted heavy mpg histograms by No. of Cyl and Suv&quot;</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 11 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="numerical-summaries" class="section level2">
<h2><span class="header-section-number">7.3</span> Numerical Summaries</h2>
<p>Throughout this chapter, you will use data from gapminder, which tracks demographic data in countries of the world over time. To learn more about it, you can bring up the help file with ?gapminder.</p>
<p>For this exercise, focus on how the life expectancy differs from continent to continent. This requires that you conduct your analysis not at the country level, but aggregated up to the continent level. This is made possible by the one-two punch of group_by() and summarize(), a very powerful syntax for carrying out the same analysis on different subsets of the full dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gapminder)

<span class="co"># Create dataset of 2007 data</span>
gap2007 &lt;-<span class="st"> </span><span class="kw">filter</span>(gapminder, year ==<span class="st"> </span><span class="dv">2007</span>)

<span class="co"># Compute groupwise mean and median lifeExp</span>
gap2007 %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(continent) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw">mean</span>(lifeExp),
            <span class="kw">median</span>(lifeExp))</code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   continent `mean(lifeExp)` `median(lifeExp)`
##      &lt;fctr&gt;           &lt;dbl&gt;             &lt;dbl&gt;
## 1    Africa              55                53
## 2  Americas              74                73
## 3      Asia              71                72
## 4    Europe              78                79
## 5   Oceania              81                81</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generate box plots of lifeExp for each continent</span>
gap2007 %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> lifeExp)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Let“s extend the powerful group_by() and summarize() syntax to measures of spread. If you”re unsure whether you“re working with symmetric or skewed distributions, it”s a good idea to consider a robust measure like IQR in addition to the usual measures of variance or standard deviation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute groupwise measures of spread</span>
gap2007 %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(continent) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw">sd</span>(lifeExp),
            <span class="kw">IQR</span>(lifeExp),
            <span class="kw">n</span>())</code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   continent `sd(lifeExp)` `IQR(lifeExp)` `n()`
##      &lt;fctr&gt;         &lt;dbl&gt;          &lt;dbl&gt; &lt;int&gt;
## 1    Africa          9.63          11.61    52
## 2  Americas          4.44           4.63    25
## 3      Asia          7.96          10.15    33
## 4    Europe          2.98           4.78    30
## 5   Oceania          0.73           0.52     2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generate overlaid density plots</span>
gap2007 %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lifeExp, <span class="dt">fill =</span> continent)) +
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>)</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute stats for lifeExp in Americas</span>
gap2007 %&gt;%
<span class="st">  </span><span class="kw">filter</span>(continent ==<span class="st"> &quot;Americas&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw">mean</span>(lifeExp),
            <span class="kw">sd</span>(lifeExp))</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   `mean(lifeExp)` `sd(lifeExp)`
##             &lt;dbl&gt;         &lt;dbl&gt;
## 1              74           4.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute stats for population</span>
gap2007 %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw">median</span>(pop),
            <span class="kw">IQR</span>(pop))</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   `median(pop)` `IQR(pop)`
##           &lt;dbl&gt;      &lt;dbl&gt;
## 1      10517531   26702008</code></pre>
<div id="transformations" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Transformations</h3>
<p>In some data, there are different ‘humps’ in the distribution, which are calls the modes or the modality of the dataset</p>
<ul>
<li><strong>Unimode</strong> - single mean, this is a normal distribtion</li>
<li><strong>Bimodal</strong> - two common distributions</li>
<li><strong>Multimodal</strong> - three modes or more</li>
</ul>
<p>We also should consider whether the distribution is skewed. Right skewed data has a long tail to the right, with the majority of the distribution to the left - we often see this with income distributions. Left skewed has a small number of observations to the left and the majoirty of the distribution to the right. A normal distribution is typically smyterical.</p>
<p>Highly skewed distributions can make it very difficult to learn anything from a visualization. Transformations can be helpful in revealing the more subtle structure.</p>
<p>Here you’ll focus on the population variable, which exhibits strong right skew, and transform it with the natural logarithm function (log() in R).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create density plot of old variable</span>
gap2007 %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pop)) +
<span class="st">  </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Transform the skewed pop variable</span>
gap2007 &lt;-<span class="st"> </span>gap2007 %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_pop =</span> <span class="kw">log</span>(pop))

<span class="co"># Create density plot of new variable</span>
gap2007 %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_pop)) +
<span class="st">  </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
</div>
<div id="outliers" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Outliers</h3>
<p>It is often useful within a dataset to identify, using a column, whether the data is an outlier, this can be done by using the mutate function e.g. df &lt;- df %&gt;% mutate(is_outlier &gt; value), then filtering and arranging the resulting table e.g. df %&gt;% filter(is_outlier) %&gt;% arrange(desc(value)). We can also use this outlier column to remove the values from a plot e.g. df %&gt;% filter(!is_outlier) %&gt;% ggplot … The determination of the outlier value might be arbitary, or you could use a percentile value (say top or bottom 2%).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Filter for Asia, add column indicating outliers</span>
gap_asia &lt;-<span class="st"> </span>gap2007 %&gt;%
<span class="st">  </span><span class="kw">filter</span>(continent ==<span class="st"> &quot;Asia&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">is_outlier =</span> lifeExp &lt;<span class="dv">50</span>)

<span class="co"># Remove outliers, create box plot of lifeExp</span>
gap_asia %&gt;%
<span class="st">  </span><span class="kw">filter</span>(!is_outlier) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> lifeExp)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
<div id="email-case-study" class="section level2">
<h2><span class="header-section-number">7.4</span> Email Case Study</h2>
<p>The example EDA comes from manually classified 3,900+ emails from the openintro package. Is there an association between spam and the length of an email? You could imagine a story either way:</p>
<ul>
<li>Spam is more likely to be a short message tempting me to click on a link, or *My normal email is likely shorter since I exchange brief emails with my friends all the time.</li>
</ul>
<p>Here, you’ll use the email dataset to settle that question. Begin by bringing up the help file and learning about all the variables with ?email.</p>
<p>As you explore the association between spam and the length of an email, use this opportunity to try out linking a dplyr chain with the layers in a ggplot2 object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(openintro)</code></pre></div>
<pre><code>## Please visit openintro.org for free statistics materials</code></pre>
<pre><code>## 
## Attaching package: &#39;openintro&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     cars</code></pre>
<pre><code>## The following object is masked from &#39;package:datasets&#39;:
## 
##     cars</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute summary statistics</span>
email %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(spam) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="kw">median</span>(num_char), <span class="kw">IQR</span>(num_char))</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##    spam `median(num_char)` `IQR(num_char)`
##   &lt;dbl&gt;              &lt;dbl&gt;           &lt;dbl&gt;
## 1     0                6.8            13.6
## 2     1                1.0             2.8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create plot</span>
email %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_num_char =</span> <span class="kw">log</span>(num_char)) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(spam), <span class="dt">y =</span> log_num_char)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Let’s look at a more obvious indicator of spam: exclamation marks. exclaim_mess contains the number of exclamation marks in each message. Using summary statistics and visualization, see if there is a relationship between this variable and whether or not a message is spam.</p>
<p>Note: when computing the log(0) is -Inf in R, which isn’t a very useful value! You can get around this by adding a small number (like .01) to the quantity inside the log() function. This way, your value is never zero. This small shift to the right won’t affect your results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute center and spread for exclaim_mess by spam</span>
email %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(spam) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="kw">mean</span>(exclaim_mess), <span class="kw">sd</span>(exclaim_mess))</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##    spam `mean(exclaim_mess)` `sd(exclaim_mess)`
##   &lt;dbl&gt;                &lt;dbl&gt;              &lt;dbl&gt;
## 1     0                  6.5                 48
## 2     1                  7.3                 80</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create plot for spam and exclaim_mess</span>
email %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw">log</span>(exclaim_mess)+<span class="fl">0.1</span>)) +
<span class="st">  </span><span class="kw">geom_histogram</span>() +
<span class="st">  </span><span class="kw">facet_wrap</span>( ~<span class="st"> </span>spam) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Number of exclamation marks by not-spam vs spam&quot;</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 1435 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>If it was difficult to work with the heavy skew of exclaim_mess, the number of images attached to each email (image) poses even more of a challenge.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(email$image)</code></pre></div>
<pre><code>## 
##    0    1    2    3    4    5    9   20 
## 3811   76   17   11    2    2    1    1</code></pre>
<p>Recall that this tabulates the number of cases in each category (so there were 3811 emails with 0 images, for example). Given the very low counts at the higher number of images, let’s collapse image into a categorical variable that indicates whether or not the email had at least one image. In this exercise, you’ll create this new variable and explore its association with spam.</p>
<p>** Here we deal with zero inflation** by converting the many zero values and the non zeros in to a categorical variable. There are other strategies, such as doing analysis on these two groups seperatley.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create plot of proportion of spam by image</span>
email %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">has_image =</span> image &gt;<span class="st"> </span><span class="dv">0</span>) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> has_image, <span class="dt">fill =</span> <span class="kw">factor</span>(spam))) +
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>)</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Sometimes it is neccessary to check if our understanding of the data and how it has been created is correct and if the values we expect are in fact true.</p>
<p>In this instance, we check first if the number of charecters in the email is greater than zero (which it should be), then secondly whether images count as attachments using a boolean operator. If image is never greater than attach, we can infer that images are counted as attachments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Verify that all emails have non-negative values for num_char</span>
<span class="kw">sum</span>(email$num_char &lt;<span class="st"> </span><span class="dv">0</span>)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test if images count as attachments</span>
<span class="kw">sum</span>(email$images &gt;=<span class="st"> </span>email$attach)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>When you have a specific question about a dataset, you can find your way to an answer by carefully constructing the appropriate chain of R code. For example, consider the following question:</p>
<blockquote>
<p>“Within non-spam emails, is the typical length of emails shorter for those that were sent to multiple people?”</p>
</blockquote>
<p>This can be answered with the following chain:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">email %&gt;%
<span class="st">   </span><span class="kw">filter</span>(spam ==<span class="st"> &quot;not-spam&quot;</span>) %&gt;%
<span class="st">   </span><span class="kw">group_by</span>(to_multiple) %&gt;%
<span class="st">   </span><span class="kw">summarize</span>(<span class="kw">median</span>(num_char))</code></pre></div>
<pre><code>## # A tibble: 0 x 2
## # ... with 2 variables: to_multiple &lt;dbl&gt;, median(num_char) &lt;lgl&gt;</code></pre>
<p>The code makes it clear that you are using num_char to measure the length of an email and median() as the measure of what is typical. If you run this code, you’ll learn that the answer to the question is “yes”: the typical length of non-spam sent to multiple people is a bit lower than those sent to only one person.</p>
<p>This chain concluded with summary statistics, but others might end in a plot; it all depends on the question that you’re trying to answer.</p>
<blockquote>
<p>For emails containing the word “dollar”, does the typical spam email contain a greater number of occurrences of the word than the typical non-spam email? Create a summary statistic that answers this question. If you encounter an email with greater than 10 occurrences of the word “dollar”, is it more likely to be spam or not-spam? Create a barchart that answers this question.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Question 1</span>
email %&gt;%
<span class="st">  </span><span class="kw">filter</span>(dollar &gt;<span class="st"> </span><span class="dv">0</span>) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(spam) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="kw">median</span>(dollar))</code></pre></div>
<pre><code>## # A tibble: 2 x 2
##    spam `median(dollar)`
##   &lt;dbl&gt;            &lt;dbl&gt;
## 1     0                4
## 2     1                2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Question 2</span>
email %&gt;%
<span class="st">  </span><span class="kw">filter</span>(dollar &gt;<span class="st"> </span><span class="dv">10</span>) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spam)) +
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Turn your attention to the variable called number. To explore the association between this variable and spam, select and construct an informative plot. For illustrating relationships between categorical variables, you’ve seen</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reorder levels</span>
email$number &lt;-<span class="st"> </span><span class="kw">factor</span>(email$number, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;big&quot;</span>))

<span class="co"># Construct plot of number</span>
<span class="kw">ggplot</span>(email, <span class="kw">aes</span>(<span class="dt">x =</span> number)) +
<span class="st">  </span><span class="kw">geom_bar</span>() +
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>spam)</code></pre></div>
<p><img src="EDA_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="references-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlation-and-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Study-Notes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
